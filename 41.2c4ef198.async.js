(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[41],{"72k+":function(e,t,a){"use strict";var r=a("mZ4U");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("Mf8d");var n=r(a("4OHk"));a("6/yB");var u=r(a("SE39"));a("Gcrx");var l=r(a("Wyac"));a("4ADO");var d=r(a("wty1"));a("NWD0");var o=r(a("2L3m")),s=r(a("cO38")),i=h(a("xwgP")),c=a("GNvi"),m=h(a("vTut")),f=r(a("BS6i")),g=r(a("hTBk")),v=r(a("CLrh")),y=r(a("yq+b")),b=a("N8P2");function p(e){if("function"!==typeof WeakMap)return null;var t=new WeakMap,a=new WeakMap;return(p=function(e){return e?a:t})(e)}function h(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==typeof e&&"function"!==typeof e)return{default:e};var a=p(t);if(a&&a.has(e))return a.get(e);var r={},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var u in e)if("default"!==u&&Object.prototype.hasOwnProperty.call(e,u)){var l=n?Object.getOwnPropertyDescriptor(e,u):null;l&&(l.get||l.set)?Object.defineProperty(r,u,l):r[u]=e[u]}return r.default=e,a&&a.set(e,r),r}var M=m.default.ChartCard,D=m.default.MiniArea,E=m.default.MiniBar,w=m.default.Field,O={xs:24,sm:12,md:12,lg:12,xl:6,style:{marginBottom:24}},k=function(e){var t=e.loading,a=e.visitData,r={cpu:0,memoryMax:0,memoryUsed:0,messageData:[],sameDay:0,month:0,metadata:{},eventData:[]},p=(0,i.useState)(r.cpu),h=(0,s.default)(p,2),k=h[0],Y=h[1],j=(0,i.useState)(r.memoryMax),S=(0,s.default)(j,2),x=S[0],H=S[1],P=(0,i.useState)(r.memoryUsed),C=(0,s.default)(P,2),N=C[0],W=C[1],T=(0,i.useState)(r.sameDay),A=(0,s.default)(T,2),B=A[0],F=A[1],q=(0,i.useState)(r.month),U=(0,s.default)(q,2),_=U[0],G=U[1],J=(0,i.useState)(r.month),L=(0,s.default)(J,2),R=L[0],V=L[1],Z=(0,i.useState)(r.month),z=(0,s.default)(Z,2),I=z[0],K=z[1],Q=(0,i.useState)(r.month),X=(0,s.default)(Q,2),$=X[0],ee=X[1],te=(0,i.useState)(r.messageData),ae=(0,s.default)(te,1),re=ae[0],ne=(0,i.useState)(!0),ue=(0,s.default)(ne,2),le=ue[0],de=ue[1],oe=(0,i.useState)(!0),se=(0,s.default)(oe,2),ie=se[0],ce=se[1],me=function(){var e=new Date;e.setDate(e.getDate()-30);var t=e.getFullYear(),a=e.getMonth()+1<10?"0".concat(e.getMonth()+1):e.getMonth()+1,r=e.getDate()<10?"0".concat(e.getDate()):e.getDate();return"".concat(t,"-").concat(a,"-").concat(r," 00:00:00")},fe=function(){var e=[{dashboard:"device",object:"message",measurement:"quantity",dimension:"agg",group:"sameDay",params:{time:"1d",format:"yyyy-MM-dd"}},{dashboard:"device",object:"message",measurement:"quantity",dimension:"agg",group:"sameMonth",params:{limit:30,time:"1d",format:"yyyy-MM-dd",from:me(),to:(0,y.default)(new Date).format("YYYY-MM-DD")+" 23:59:59"}},{dashboard:"device",object:"message",measurement:"quantity",dimension:"agg",group:"month",params:{time:"1M",format:"yyyy-MM-dd",from:(0,y.default)().startOf("month").format("YYYY-MM-DD HH:mm:ss"),to:(0,y.default)(new Date).format("YYYY-MM-DD HH:mm:ss")}}];v.default.analysis.getMulti(e).then(function(e){var t=null===e||void 0===e?void 0:e.result;200===e.status&&t.forEach(function(e){switch(e.group){case"sameDay":F(e.data.value);break;case"month":G(e.data.value);break;case"sameMonth":re.push({x:(0,y.default)(new Date(e.data.timeString)).format("YYYY-MM-DD"),y:Number(e.data.value)});break;default:break}}),ce(!1)})},ge=function(){var e=[{dashboard:"device",object:"status",measurement:"record",dimension:"current",group:"deviceOnline",params:{state:"online"}},{dashboard:"device",object:"status",measurement:"record",dimension:"current",group:"deviceCount"},{dashboard:"device",object:"status",measurement:"record",dimension:"current",group:"deviceNotActive",params:{state:"notActive"}},{dashboard:"device",object:"status",measurement:"record",dimension:"aggOnline",group:"aggOnline",params:{limit:20,time:"1d",format:"yyyy-MM-dd"}}];v.default.analysis.getMulti(e).then(function(e){var t=null===e||void 0===e?void 0:e.result;200===e.status&&(t.forEach(function(e){switch(e.group){case"aggOnline":a.push({x:(0,y.default)(new Date(e.data.timeString)).format("YYYY-MM-DD"),y:Number(e.data.value)});break;case"deviceOnline":V(e.data.value);break;case"deviceCount":K(e.data.value);break;case"deviceNotActive":ee(e.data.value);break;default:break}}),a=a.reverse()),de(!1)})};return(0,i.useEffect)(function(){ge(),fe();var e=(0,b.getWebsocket)("home-page-statistics-cpu-realTime","/dashboard/systemMonitor/cpu/usage/realTime",{params:{history:1}}).subscribe(function(e){var t=e.payload;Y(t.value)}),t=(0,b.getWebsocket)("home-page-statistics-jvm-realTime","/dashboard/jvmMonitor/memory/info/realTime",{params:{history:1}}).subscribe(function(e){var t=e.payload;H(t.value.max),W(t.value.used)});return function(){e&&e.unsubscribe(),t&&t.unsubscribe()}},[]),i.default.createElement(o.default,{gutter:24},i.default.createElement(d.default,Object.assign({},O),i.default.createElement(l.default,{spinning:le},i.default.createElement(M,{bordered:!1,title:"\u5f53\u524d\u5728\u7ebf",action:i.default.createElement(u.default,{title:"\u5237\u65b0"},i.default.createElement(n.default,{type:"sync",onClick:function(){de(!0),ge()}})),total:(0,f.default)(R).format("0,0"),footer:i.default.createElement("div",{style:{whiteSpace:"nowrap",overflow:"hidden"}},i.default.createElement(w,{style:{marginRight:40,float:"left"},label:i.default.createElement(c.FormattedMessage,{id:"analysis.analysis.device-total",defaultMessage:"\u8bbe\u5907\u603b\u91cf"}),value:(0,f.default)(I).format("0,0")}),i.default.createElement(w,{label:i.default.createElement(c.FormattedMessage,{id:"analysis.analysis.device-activation",defaultMessage:"\u672a\u6fc0\u6d3b\u8bbe\u5907"}),value:(0,f.default)($).format("0,0")})),contentHeight:46},i.default.createElement(E,{data:a})))),i.default.createElement(d.default,Object.assign({},O),i.default.createElement(l.default,{spinning:ie},i.default.createElement(M,{bordered:!1,loading:t,title:"\u4eca\u65e5\u8bbe\u5907\u6d88\u606f\u91cf",action:i.default.createElement(u.default,{title:"\u5237\u65b0"},i.default.createElement(n.default,{type:"sync",onClick:function(){ce(!0),fe()}})),total:(0,f.default)(B).format("0,0"),footer:i.default.createElement(w,{label:"\u5f53\u6708\u8bbe\u5907\u6d88\u606f\u91cf",value:(0,f.default)(_).format("0,0")}),contentHeight:46},i.default.createElement(D,{color:"#975FE4",data:re})))),i.default.createElement(d.default,Object.assign({},O),i.default.createElement(M,{loading:t,bordered:!1,title:"CPU\u4f7f\u7528\u7387",contentHeight:120},i.default.createElement(g.default,{height:169,percent:k}))),i.default.createElement(d.default,Object.assign({},O),i.default.createElement(M,{loading:t,bordered:!1,title:"JVM\u5185\u5b58",contentHeight:120},i.default.createElement(m.Gauge,{height:169,percent:N,memoryMax:x}))))},Y=k;t.default=Y}}]);