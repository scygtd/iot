(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[37],{"72k+":function(e,t,a){"use strict";var n=a("fbTi"),r=a("mZ4U");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("Mf8d");var d=r(a("4OHk"));a("6/yB");var u=r(a("SE39"));a("Gcrx");var l=r(a("Wyac"));a("4ADO");var o=r(a("wty1"));a("NWD0");var s=r(a("2L3m")),i=r(a("cO38")),c=n(a("xwgP")),m=a("GNvi"),f=n(a("vTut")),g=r(a("BS6i")),v=r(a("hTBk")),y=r(a("CLrh")),b=r(a("yq+b")),h=a("N8P2"),p=f.default.ChartCard,M=f.default.MiniArea,E=f.default.MiniBar,D=f.default.Field,k={xs:24,sm:12,md:12,lg:12,xl:6,style:{marginBottom:24}},w=function(e){var t=e.loading,a=e.visitData,n={cpu:0,memoryMax:0,memoryUsed:0,messageData:[],sameDay:0,month:0,metadata:{},eventData:[]},r=(0,c.useState)(n.cpu),w=(0,i.default)(r,2),Y=w[0],S=w[1],j=(0,c.useState)(n.memoryMax),O=(0,i.default)(j,2),x=O[0],C=O[1],N=(0,c.useState)(n.memoryUsed),T=(0,i.default)(N,2),A=T[0],B=T[1],F=(0,c.useState)(n.sameDay),H=(0,i.default)(F,2),q=H[0],P=H[1],U=(0,c.useState)(n.month),W=(0,i.default)(U,2),G=W[0],J=W[1],L=(0,c.useState)(n.month),_=(0,i.default)(L,2),R=_[0],V=_[1],Z=(0,c.useState)(n.month),z=(0,i.default)(Z,2),I=z[0],K=z[1],Q=(0,c.useState)(n.month),X=(0,i.default)(Q,2),$=X[0],ee=X[1],te=(0,c.useState)(n.messageData),ae=(0,i.default)(te,1),ne=ae[0],re=(0,c.useState)(!0),de=(0,i.default)(re,2),ue=de[0],le=de[1],oe=(0,c.useState)(!0),se=(0,i.default)(oe,2),ie=se[0],ce=se[1],me=function(){var e=new Date;e.setDate(e.getDate()-30);var t=e.getFullYear(),a=e.getMonth()+1<10?"0".concat(e.getMonth()+1):e.getMonth()+1,n=e.getDate()<10?"0".concat(e.getDate()):e.getDate();return"".concat(t,"-").concat(a,"-").concat(n," 00:00:00")},fe=function(){var e=[{dashboard:"device",object:"message",measurement:"quantity",dimension:"agg",group:"sameDay",params:{time:"1d",format:"yyyy-MM-dd"}},{dashboard:"device",object:"message",measurement:"quantity",dimension:"agg",group:"sameMonth",params:{limit:30,time:"1d",format:"yyyy-MM-dd",from:me(),to:(0,b.default)(new Date).format("YYYY-MM-DD")+" 23:59:59"}},{dashboard:"device",object:"message",measurement:"quantity",dimension:"agg",group:"month",params:{time:"1M",format:"yyyy-MM-dd",from:me(),to:(0,b.default)(new Date).format("YYYY-MM-DD")+" 23:59:59"}}];y.default.analysis.getMulti(e).then(function(e){var t=null===e||void 0===e?void 0:e.result;200===e.status&&t.forEach(function(e){switch(e.group){case"sameDay":P(e.data.value);break;case"month":J(e.data.value);break;case"sameMonth":ne.push({x:(0,b.default)(new Date(e.data.timeString)).format("YYYY-MM-DD"),y:Number(e.data.value)});break;default:break}}),ce(!1)})},ge=function(){var e=[{dashboard:"device",object:"status",measurement:"record",dimension:"current",group:"deviceOnline",params:{state:"online"}},{dashboard:"device",object:"status",measurement:"record",dimension:"current",group:"deviceCount"},{dashboard:"device",object:"status",measurement:"record",dimension:"current",group:"deviceNotActive",params:{state:"notActive"}},{dashboard:"device",object:"status",measurement:"record",dimension:"aggOnline",group:"aggOnline",params:{limit:20,time:"1d",format:"yyyy-MM-dd"}}];y.default.analysis.getMulti(e).then(function(e){var t=null===e||void 0===e?void 0:e.result;200===e.status&&(t.forEach(function(e){switch(e.group){case"aggOnline":a.push({x:(0,b.default)(new Date(e.data.timeString)).format("YYYY-MM-DD"),y:Number(e.data.value)});break;case"deviceOnline":V(e.data.value);break;case"deviceCount":K(e.data.value);break;case"deviceNotActive":ee(e.data.value);break;default:break}}),a=a.reverse()),le(!1)})};return(0,c.useEffect)(function(){ge(),fe();var e=(0,h.getWebsocket)("home-page-statistics-cpu-realTime","/dashboard/systemMonitor/cpu/usage/realTime",{params:{history:1}}).subscribe(function(e){var t=e.payload;S(t.value)}),t=(0,h.getWebsocket)("home-page-statistics-jvm-realTime","/dashboard/jvmMonitor/memory/info/realTime",{params:{history:1}}).subscribe(function(e){var t=e.payload;C(t.value.max),B(t.value.used)});return function(){e&&e.unsubscribe(),t&&t.unsubscribe()}},[]),c.default.createElement(s.default,{gutter:24},c.default.createElement(o.default,Object.assign({},k),c.default.createElement(l.default,{spinning:ue},c.default.createElement(p,{bordered:!1,title:"\u5f53\u524d\u5728\u7ebf",action:c.default.createElement(u.default,{title:"\u5237\u65b0"},c.default.createElement(d.default,{type:"sync",onClick:function(){le(!0),ge()}})),total:(0,g.default)(R).format("0,0"),footer:c.default.createElement("div",{style:{whiteSpace:"nowrap",overflow:"hidden"}},c.default.createElement(D,{style:{marginRight:40,float:"left"},label:c.default.createElement(m.FormattedMessage,{id:"analysis.analysis.device-total",defaultMessage:"\u8bbe\u5907\u603b\u91cf"}),value:(0,g.default)(I).format("0,0")}),c.default.createElement(D,{label:c.default.createElement(m.FormattedMessage,{id:"analysis.analysis.device-activation",defaultMessage:"\u672a\u6fc0\u6d3b\u8bbe\u5907"}),value:(0,g.default)($).format("0,0")})),contentHeight:46},c.default.createElement(E,{data:a})))),c.default.createElement(o.default,Object.assign({},k),c.default.createElement(l.default,{spinning:ie},c.default.createElement(p,{bordered:!1,loading:t,title:"\u4eca\u65e5\u8bbe\u5907\u6d88\u606f\u91cf",action:c.default.createElement(u.default,{title:"\u5237\u65b0"},c.default.createElement(d.default,{type:"sync",onClick:function(){ce(!0),fe()}})),total:(0,g.default)(q).format("0,0"),footer:c.default.createElement(D,{label:"\u5f53\u6708\u8bbe\u5907\u6d88\u606f\u91cf",value:(0,g.default)(G).format("0,0")}),contentHeight:46},c.default.createElement(M,{color:"#975FE4",data:ne})))),c.default.createElement(o.default,Object.assign({},k),c.default.createElement(p,{loading:t,bordered:!1,title:"CPU\u4f7f\u7528\u7387",contentHeight:120},c.default.createElement(v.default,{height:169,percent:Y}))),c.default.createElement(o.default,Object.assign({},k),c.default.createElement(p,{loading:t,bordered:!1,title:"JVM\u5185\u5b58",contentHeight:120},c.default.createElement(f.Gauge,{height:169,percent:A,memoryMax:x}))))},Y=w;t.default=Y}}]);