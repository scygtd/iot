(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[54],{"72k+":function(e,t,a){"use strict";var n=a("tAuX"),d=a("g09b");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("Pwec");var r=d(a("CtXQ"));a("5Dmo");var u=d(a("3S7+"));a("T2oS");var l=d(a("W9HT"));a("jCWc");var o=d(a("kPKH"));a("14J3");var s=d(a("BMrR")),i=d(a("qIgq")),c=n(a("q1tI")),m=a("Y2fQ"),f=n(a("vTut")),g=d(a("ZhIB")),v=d(a("hTBk")),b=d(a("CLrh")),y=d(a("wd/R")),h=a("N8P2"),p=f.default.ChartCard,M=f.default.MiniArea,E=f.default.MiniBar,D=f.default.Field,k={xs:24,sm:12,md:12,lg:12,xl:6,style:{marginBottom:24}},w=function(e){var t=e.loading,a=e.visitData,n={cpu:0,memoryMax:0,memoryUsed:0,messageData:[],sameDay:0,month:0,metadata:{},eventData:[]},d=(0,c.useState)(n.cpu),w=(0,i.default)(d,2),Y=w[0],S=w[1],j=(0,c.useState)(n.memoryMax),C=(0,i.default)(j,2),O=C[0],x=C[1],T=(0,c.useState)(n.memoryUsed),q=(0,i.default)(T,2),H=q[0],A=q[1],B=(0,c.useState)(n.sameDay),F=(0,i.default)(B,2),N=F[0],P=F[1],J=(0,c.useState)(n.month),W=(0,i.default)(J,2),I=W[0],R=W[1],U=(0,c.useState)(n.month),Q=(0,i.default)(U,2),X=Q[0],_=Q[1],G=(0,c.useState)(n.month),K=(0,i.default)(G,2),L=K[0],V=K[1],Z=(0,c.useState)(n.month),z=(0,i.default)(Z,2),$=z[0],ee=z[1],te=(0,c.useState)(n.messageData),ae=(0,i.default)(te,1),ne=ae[0],de=(0,c.useState)(!0),re=(0,i.default)(de,2),ue=re[0],le=re[1],oe=(0,c.useState)(!0),se=(0,i.default)(oe,2),ie=se[0],ce=se[1],me=function(){var e=new Date;e.setDate(e.getDate()-30);var t=e.getFullYear(),a=e.getMonth()+1<10?"0".concat(e.getMonth()+1):e.getMonth()+1,n=e.getDate()<10?"0".concat(e.getDate()):e.getDate();return"".concat(t,"-").concat(a,"-").concat(n," 00:00:00")},fe=function(){var e=[{dashboard:"device",object:"message",measurement:"quantity",dimension:"agg",group:"sameDay",params:{time:"1d",format:"yyyy-MM-dd"}},{dashboard:"device",object:"message",measurement:"quantity",dimension:"agg",group:"sameMonth",params:{limit:30,time:"1d",format:"yyyy-MM-dd",from:me(),to:(0,y.default)(new Date).add(1,"days").format("YYYY-MM-DD")+" 00:00:00"}},{dashboard:"device",object:"message",measurement:"quantity",dimension:"agg",group:"month",params:{time:"1M",format:"yyyy-MM-dd",from:me(),to:(0,y.default)(new Date).add(1,"days").format("YYYY-MM-DD")+" 00:00:00"}}];b.default.analysis.getMulti(e).then(function(e){var t=null===e||void 0===e?void 0:e.result;200===e.status&&t.forEach(function(e){switch(e.group){case"sameDay":P(e.data.value);break;case"month":R(e.data.value);break;case"sameMonth":ne.push({x:(0,y.default)(new Date(e.data.timeString)).format("YYYY-MM-DD"),y:Number(e.data.value)});break;default:break}}),ce(!1)})},ge=function(){var e=[{dashboard:"device",object:"status",measurement:"record",dimension:"current",group:"deviceOnline",params:{state:"online"}},{dashboard:"device",object:"status",measurement:"record",dimension:"current",group:"deviceCount"},{dashboard:"device",object:"status",measurement:"record",dimension:"current",group:"deviceNotActive",params:{state:"notActive"}},{dashboard:"device",object:"status",measurement:"record",dimension:"aggOnline",group:"aggOnline",params:{limit:20,time:"1d",format:"yyyy-MM-dd"}}];b.default.analysis.getMulti(e).then(function(e){var t=null===e||void 0===e?void 0:e.result;200===e.status&&t.forEach(function(e){switch(e.group){case"aggOnline":a.push({x:(0,y.default)(new Date(e.data.timeString)).format("YYYY-MM-DD"),y:Number(e.data.value)});break;case"deviceOnline":_(e.data.value);break;case"deviceCount":V(e.data.value);break;case"deviceNotActive":ee(e.data.value);break;default:break}}),le(!1)})};return(0,c.useEffect)(function(){ge(),fe();var e=(0,h.getWebsocket)("home-page-statistics-cpu-realTime","/dashboard/systemMonitor/cpu/usage/realTime",{params:{history:1}}).subscribe(function(e){var t=e.payload;S(t.value)}),t=(0,h.getWebsocket)("home-page-statistics-jvm-realTime","/dashboard/jvmMonitor/memory/info/realTime",{params:{history:1}}).subscribe(function(e){var t=e.payload;x(t.value.max),A(t.value.used)});return function(){e&&e.unsubscribe(),t&&t.unsubscribe()}},[]),c.default.createElement(s.default,{gutter:24},c.default.createElement(o.default,Object.assign({},k),c.default.createElement(l.default,{spinning:ue},c.default.createElement(p,{bordered:!1,title:"\u5f53\u524d\u5728\u7ebf",action:c.default.createElement(u.default,{title:"\u5237\u65b0"},c.default.createElement(r.default,{type:"sync",onClick:function(){le(!0),ge()}})),total:(0,g.default)(X).format("0,0"),footer:c.default.createElement("div",{style:{whiteSpace:"nowrap",overflow:"hidden"}},c.default.createElement(D,{style:{marginRight:40,float:"left"},label:c.default.createElement(m.FormattedMessage,{id:"analysis.analysis.device-total",defaultMessage:"\u8bbe\u5907\u603b\u91cf"}),value:(0,g.default)(L).format("0,0")}),c.default.createElement(D,{label:c.default.createElement(m.FormattedMessage,{id:"analysis.analysis.device-activation",defaultMessage:"\u672a\u6fc0\u6d3b\u8bbe\u5907"}),value:(0,g.default)($).format("0,0")})),contentHeight:46},c.default.createElement(E,{data:a})))),c.default.createElement(o.default,Object.assign({},k),c.default.createElement(l.default,{spinning:ie},c.default.createElement(p,{bordered:!1,loading:t,title:"\u4eca\u65e5\u8bbe\u5907\u6d88\u606f\u91cf",action:c.default.createElement(u.default,{title:"\u5237\u65b0"},c.default.createElement(r.default,{type:"sync",onClick:function(){ce(!0),fe()}})),total:(0,g.default)(N).format("0,0"),footer:c.default.createElement(D,{label:"\u5f53\u6708\u8bbe\u5907\u6d88\u606f\u91cf",value:(0,g.default)(I).format("0,0")}),contentHeight:46},c.default.createElement(M,{color:"#975FE4",data:ne})))),c.default.createElement(o.default,Object.assign({},k),c.default.createElement(p,{loading:t,bordered:!1,title:"CPU\u4f7f\u7528\u7387",contentHeight:120},c.default.createElement(v.default,{height:169,percent:Y}))),c.default.createElement(o.default,Object.assign({},k),c.default.createElement(p,{loading:t,bordered:!1,title:"JVM\u5185\u5b58",contentHeight:120},c.default.createElement(f.Gauge,{height:169,percent:H,memoryMax:O}))))},Y=w;t.default=Y}}]);